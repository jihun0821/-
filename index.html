<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firestore Teams Data Uploader</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            padding: 40px;
            max-width: 600px;
            width: 100%;
            backdrop-filter: blur(10px);
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-size: 28px;
            font-weight: 700;
        }

        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-weight: 600;
            font-size: 14px;
        }

        input[type="text"] {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: #fafbfc;
        }

        input[type="text"]:focus {
            outline: none;
            border-color: #667eea;
            background: white;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .config-info {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 25px;
        }

        .config-info h3 {
            color: #495057;
            margin-bottom: 15px;
            font-size: 16px;
        }

        .config-info p {
            color: #6c757d;
            font-size: 14px;
            line-height: 1.5;
            margin-bottom: 10px;
        }

        .config-info code {
            background: #e9ecef;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 13px;
        }

        button {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
        }

        button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .status {
            margin-top: 20px;
            padding: 15px;
            border-radius: 10px;
            font-weight: 500;
        }

        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .status.info {
            background: #cce7ff;
            color: #004085;
            border: 1px solid #b3d7ff;
        }

        .progress {
            width: 100%;
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            width: 0%;
            transition: width 0.3s ease;
        }

        .data-preview {
            margin-top: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
        }

        .data-preview h4 {
            color: #495057;
            margin-bottom: 15px;
        }

        .team-item {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            border-left: 4px solid #667eea;
        }

        .team-item h5 {
            color: #333;
            margin-bottom: 8px;
        }

        .team-item p {
            color: #666;
            font-size: 14px;
            margin: 4px 0;
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🏫 Firestore Teams Data Uploader</h1>
        
        <div class="config-info">
            <h3>Firebase 설정 정보</h3>
            <p>Firebase 콘솔에서 다음 정보를 확인하여 입력해주세요:</p>
            <p>1. 프로젝트 설정 → 일반 → 웹 앱에서 <code>apiKey</code>, <code>projectId</code> 등 확인</p>
            <p>2. Firestore Database가 활성화되어 있는지 확인</p>
            <p>3. 보안 규칙이 쓰기를 허용하도록 설정되어 있는지 확인</p>
        </div>

        <form id="configForm">
            <div class="form-group">
                <label for="apiKey">API Key</label>
                <input type="text" id="apiKey" required placeholder="AIzaSyC...">
            </div>
            
            <div class="form-group">
                <label for="authDomain">Auth Domain</label>
                <input type="text" id="authDomain" required placeholder="your-project.firebaseapp.com">
            </div>
            
            <div class="form-group">
                <label for="projectId">Project ID</label>
                <input type="text" id="projectId" required placeholder="your-project-id">
            </div>
            
            <div class="form-group">
                <label for="storageBucket">Storage Bucket</label>
                <input type="text" id="storageBucket" required placeholder="your-project.appspot.com">
            </div>
            
            <div class="form-group">
                <label for="messagingSenderId">Messaging Sender ID</label>
                <input type="text" id="messagingSenderId" required placeholder="123456789">
            </div>
            
            <div class="form-group">
                <label for="appId">App ID</label>
                <input type="text" id="appId" required placeholder="1:123456789:web:abcdef">
            </div>

            <button type="submit">데이터 업로드 시작</button>
        </form>

        <div id="status" class="status hidden"></div>
        <div id="progress" class="progress hidden">
            <div id="progressBar" class="progress-bar"></div>
        </div>

        <div id="dataPreview" class="data-preview hidden">
            <h4>업로드할 데이터 미리보기</h4>
            <div id="previewContent"></div>
        </div>
    </div>

    <script type="module">
        // Firebase SDK 임포트
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore, collection, doc, setDoc } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        // 팀 데이터 정의
        const teamsData = {
            'C101': {
                lineups: {
                    first: ['김서준', '김성찬', '김시우', '전유찬', '전치원', '차재민', '허준명'],
                    second: ['송준표', '조재윤', '김현재', '손준후', '김민성', '임하균', '최주원']
                }
            },
            'C102': {
                lineups: {
                    first: ['남동율', '소건호', '임유석', '전지후', '최민준', '최정욱'],
                    second: ['박규빈', '이기영', '정해수', '김민준', '최진혁', '유준희', '이준경']
                }
            },
            'C103': {
                lineups: {
                    first: ['강준서', '배성현', '이재윤', '이주원', '차주헌', '최정환'],
                    second: ['김요한', '조우준', '임지훈', '박시원', '황규호', '김주현']
                }
            },
            'C104': {
                lineups: {
                    first: ['김민환', '양지호', '이원진', '이유겸', '한환희', '황경민', '최예준'],
                    second: ['소하윤', '남현주', '홍현수', '김윤종', '조우진', '황은결']
                }
            },
            'C105': {
                lineups: {
                    first: ['김도경', '김정준', '박지우', '유호', '이찬희', '주현태', '최이든'],
                    second: ['김재준', '임헌서', '민선호', '이재원', '강구호', '김수현']
                }
            },
            'C106': {
                lineups: {
                    first: ['김예빈', '나종원', '손재유', '이인혁', '이재원', '임태윤', '지범규'],
                    second: ['배성준', '박민성', '유윤찬', '강민찬', '장태희', '정현', '장재영']
                }
            },
            'C201': {
                lineups: {
                    first: ['가승훈', '김준우', '박무결', '윤덕녕', '조영우'],
                    second: ['금담인', '최동명', '유준석', '김은혁', '박범준', '정성훈']
                }
            },
            'C202': {
                lineups: {
                    first: ['김예준', '문태현', '염규현', '이찬혁', '정도현', '조형진'],
                    second: ['남현욱', '채동완', '이승재', '김우림', '조성익', '이재성']
                }
            },
            'C203': {
                lineups: {
                    first: ['곽예준', '문수찬', '박준형', '연응주', '전병건', '전지환', '황인철'],
                    second: ['유준상', '권민준', '박유빈', '이건우', '천태하', '황성현', '이지훈']
                }
            },
            'C204': {
                lineups: {
                    first: ['김건우', '김정찬', '오다니엘', '전현서', '정지원', '허희재'],
                    second: ['이준혁', '정관호', '김택겸', '문지훈', '윤이안', '김동혁']
                }
            },
            'C205': {
                lineups: {
                    first: ['김하민', '남규현', '오윤호', '장민석', '정민수', '홍일권'],
                    second: ['송원혁', '김윤우', '서연우', '정우진', '이건영', '정재현']
                }
            },
            'C206': {
                lineups: {
                    first: ['노민석', '육한율', '윤찬서', '임이안', '조민상', '최이준'],
                    second: ['윤수훈', '조한결', '원종환', '이경수', '노윤찬', '최윤석']
                }
            },
            'C207': {
                lineups: {
                    first: ['강형욱', '김민규', '박건후', '박민준', '이윤건', '이진한', '채현수'],
                    second: ['박은우', '연한결', '이지환', '구하결', '인서우', '김주혁', '하지후']
                }
            },
            'C301': {
                lineups: {
                    first: ['강시우', '김준영', '박석현', '박종윤', '임경서', '임지효'],
                    second: ['김보성', '박재형', '강우영', '장연규', '김한솔', '오승빈']
                }
            },
            'C302': {
                lineups: {
                    first: ['김성우', '남일국', '성준용', '윤희상', '전성민', '조인록'],
                    second: ['신윤수', '정혜종', '김재원', '김한울', '신정우', '유재현']
                }
            },
            'C303': {
                lineups: {
                    first: ['민지환', '박도현', '이시안', '이준성', '주하율', '하지형'],
                    second: ['주현우', '김재희', '안승진', '이정우', '문재현', '이재빈']
                }
            },
            'C304': {
                lineups: {
                    first: ['김현목', '김효재', '박주윤', '변지수', '손재호', '이준우', '주영진'],
                    second: ['정현빈', '김우식', '이태림', '지승혁', '홍선기', '김강민', '임민우']
                }
            },
            'C305': {
                lineups: {
                    first: ['구진모', '문용수', '박수열', '박준규', '신겸', '이충민'],
                    second: ['채서진', '지현우', '장태인', '박재현', '박준균', '임지인', '최호현']
                }
            },
            'C306': {
                lineups: {
                    first: ['김주호', '박범주', '박준성', '배영민', '유종연', '전상현'],
                    second: ['임찬희', '최다민', '이예준', '정채운', '윤두현', '차민규']
                }
            },
            'C307': {
                lineups: {
                    first: ['김지솔', '박재현', '백인준', '변하율', '이민석', '조항선'],
                    second: ['최덕상', '이재상', '정래인', '김승률', '이강민', '안정기']
                }
            }
        };

        let db = null;

        // DOM 요소들
        const configForm = document.getElementById('configForm');
        const statusDiv = document.getElementById('status');
        const progressDiv = document.getElementById('progress');
        const progressBar = document.getElementById('progressBar');
        const dataPreviewDiv = document.getElementById('dataPreview');
        const previewContent = document.getElementById('previewContent');

        // 상태 메시지 표시
        function showStatus(message, type = 'info') {
            statusDiv.textContent = message;
            statusDiv.className = `status ${type}`;
            statusDiv.classList.remove('hidden');
        }

        // 진행률 업데이트
        function updateProgress(current, total) {
            const percentage = (current / total) * 100;
            progressBar.style.width = `${percentage}%`;
            progressDiv.classList.remove('hidden');
        }

        // 데이터 미리보기 표시
        function showDataPreview() {
            const teamIds = Object.keys(teamsData);
            previewContent.innerHTML = '';
            
            teamIds.slice(0, 3).forEach(teamId => {
                const team = teamsData[teamId];
                const teamDiv = document.createElement('div');
                teamDiv.className = 'team-item';
                teamDiv.innerHTML = `
                    <h5>${teamId}</h5>
                    <p><strong>1학년:</strong> ${team.lineups.first.join(', ')}</p>
                    <p><strong>2학년:</strong> ${team.lineups.second.join(', ')}</p>
                `;
                previewContent.appendChild(teamDiv);
            });

            if (teamIds.length > 3) {
                const moreDiv = document.createElement('div');
                moreDiv.className = 'team-item';
                moreDiv.innerHTML = `<p>... 그 외 ${teamIds.length - 3}개 팀 더</p>`;
                previewContent.appendChild(moreDiv);
            }

            dataPreviewDiv.classList.remove('hidden');
        }

        // Firebase 초기화 및 데이터 업로드
        configForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const config = {
                apiKey: document.getElementById('apiKey').value.trim(),
                authDomain: document.getElementById('authDomain').value.trim(),
                projectId: document.getElementById('projectId').value.trim(),
                storageBucket: document.getElementById('storageBucket').value.trim(),
                messagingSenderId: document.getElementById('messagingSenderId').value.trim(),
                appId: document.getElementById('appId').value.trim()
            };

            try {
                showStatus('Firebase 초기화 중...', 'info');
                
                // Firebase 앱 초기화
                const app = initializeApp(config);
                db = getFirestore(app);
                
                showStatus('Firebase 연결 성공! 데이터 업로드를 시작합니다.', 'info');
                showDataPreview();
                
                // 데이터 업로드
                const teamIds = Object.keys(teamsData);
                let uploadedCount = 0;
                
                for (const teamId of teamIds) {
                    const teamData = teamsData[teamId];
                    
                    try {
                        const teamRef = doc(db, 'teams', teamId);
                        await setDoc(teamRef, teamData);
                        
                        uploadedCount++;
                        updateProgress(uploadedCount, teamIds.length);
                        showStatus(`업로드 중... (${uploadedCount}/${teamIds.length}) - ${teamId} 완료`, 'info');
                        
                        // 요청 제한을 피하기 위해 잠시 대기
                        await new Promise(resolve => setTimeout(resolve, 100));
                        
                    } catch (error) {
                        console.error(`${teamId} 업로드 실패:`, error);
                        showStatus(`${teamId} 업로드 실패: ${error.message}`, 'error');
                        return;
                    }
                }
                
                showStatus(`✅ 모든 데이터 업로드 완료! (${teamIds.length}개 팀)`, 'success');
                
            } catch (error) {
                console.error('Firebase 초기화 실패:', error);
                showStatus(`❌ Firebase 연결 실패: ${error.message}`, 'error');
            }
        });

        // 페이지 로드 시 데이터 미리보기 표시
        showDataPreview();
    </script>
</body>
</html>